<!DOCTYPE html>

<html lang="en">
  <head>
    <!-- Set basic information -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <!-- Set presentation specific meta-information -->
    <meta name="author" content="Fabio Muratore" />
    <meta name="description" content="ICRA 2021" />
    <title>Data-efficient Domain Randomization with Bayesian Optimization - ICRA 2021</title>

    <!-- Load a specific math font for MathJax (load this before reveal) -->
    <!--    <script type="text/x-mathjax-config">-->
    <!--			MathJax.Hub.Config({-->
    <!--				"HTML-CSS" : {-->
    <!--					availableFonts : ["TeX"],-->
    <!--					preferredFont : "TeX",-->
    <!--					webFont : "TeX",-->
    <!--					imageFont : null-->
    <!--				}-->
    <!--			});    -->
    <!--    </script>-->

    <!-- Link core reveal css files -->
    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />

    <!-- Link custom css fie -->
    <link rel="stylesheet" href="dist/theme/famura.css" id="theme" />

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme" />
    <!-- alternatively zenburn -->

    <!-- Diagrams -->
    <link rel="stylesheet" href="plugin/diagram/revealjs-diagram.css" />
  </head>

  <!-- =============================================================================================================== -->
  <body>
    <div class="reveal">
      <!-- =========================================================================================================== -->

      <div class="slides">
        <section style="text-align: center" data-state="no-slide-footer">
          <h3 class="title">
            Data-efficient <br />
            Domain Randomization <br />
            with <br />
            Bayesian Optimization
          </h3>
          <p>
            <b>
              Fabio Muratore<sup>1,2</sup>, Christian Eilers<sup>1,2</sup>,
              <br />
              Michael Gienger<sup>2</sup>, Jan Peters<sup>1</sup>
            </b>
          </p>
          <p>
            <sup>1</sup> Technical University of Darmstadt <br />
            <sup>2</sup> Honda Research Institute Europe
          </p>
        </section>

        <!-- d3 test slides -->
        <section>
               <div>
                <h5>Simulation-based Policy Optimization with Transferability Assessment (SPOTA)</h5>
              </div>
              <div class="fig-container"
                   data-file="Graph01.html" data-preload
                   data-graph="spota-graph.json"></div>
        </section>
        <!-- END d3 test slides -->

        <section>
          <h4>Motivation</h4>
        </section>

        <section>
          <h4>Bayesian Domain Randomization (BayRn)</h4>
          <dl>
            <dt class="fragment" data-fragment-index="1">goal</dt>
            <dd class="fragment" data-fragment-index="1">learn a policy in simulation such that transfers to the real robot</dd>
            <dt class="fragment" data-fragment-index="2">idea</dt>
            <dd class="fragment" data-fragment-index="2">model connection between return and domain distribution parameters using a GP</dd>
            <dd class="fragment" data-fragment-index="3">update the model based on sparse real-world data</dd>
          </dl>
        </section>

        <section>
          <h4>Problem Statement and Notation</h4>
          <div style="text-align: left">
            <div class="fragment fade-in">
              <p>Time-discrete stochastic dynamical system</p>
              \[ {\color{red} {\xi \sim \nu \left( \xi; \phi \right)}}, \ s_{t+1} \sim \mathcal{P} \left(s_{t+1} \big| s_t, a_t, {\color{red} \xi} \right), \ s_0 \sim\mu_0 \left( s_0, {\color{red} \xi} \right), \ a_t \sim \pi\left( s_t; \theta \right) \]
            </div>
            <div class="fragment fade-in">
              <p>Expected return for one domain</p>
              \[ J(\theta, {\color{red}\xi}, s_0) = \mathbb{E}_{\tau \sim p(\tau)} \left[ \sum\nolimits_{t=0}^{T-1} \gamma^t r(s_t, a_t) \Big| \theta, {\color{red}\xi}, s_0 \right] \]
            </div>
            <div class="fragment fade-in">
              <p>Augmentation of the standard RL objective</p>
              $$ \theta^\star = \arg\!\max_{\theta\in\Theta} \ {\color{red}{\mathbb{E}_{\xi \sim \nu(\xi;\phi)}}} \left[ \mathbb{E}_{s_0 \sim \mu_0({\color{red}\xi}; s_0)} \left[ J(\theta, {\color{red}\xi}, s_0) \right] \right] $$
            </div>
          </div>
        </section>

        <section>
          <h4>Bayesian Domain Randomization (BayRn)</h4>
          <p>Bi-level optimization problem</p>
          <div class="flex-container-row-end" style="align-items: baseline">
            <div class="flex-container-col margin-col">\[ {\color{red}{\phi^\star}} = \arg\!\max_{\phi\in\Phi} \ \mathbb{E}_{s_0 \sim \mu_0(s_0)} \big[ J^{\textrm{real}}\left( {\color{red} {\theta^\star}}, s_0\right) \big] \]</div>
            <div class="flex-container-col margin-col">upper level</div>
          </div>
          <div class="flex-container-row">
            <div class="flex-container-col">with</div>
          </div>
          <div class="flex-container-row-end" style="align-items: baseline">
            <div class="flex-container-col margin-col">\[ {\color{red}{\theta^\star(\phi)}} = \arg\! \max_{\theta\in\Theta} \ \mathbb{E}_{\xi \sim \nu(\xi;{\color{red}\phi})} \! \left[ \mathbb{E}_{s_0 \sim \mu_0(s_0;\xi)} \left[ J(\theta, \xi, s_0) \right] \right] \]</div>
            <div class="flex-container-col margin-col">lower level</div>
          </div>
        </section>

        <section>
          <h4>Bayesian Domain Randomization (BayRn)</h4>
          <p>Bi-level optimization problem</p>
          <dl>
            <dt class="fragment fade-in" data-fragment-index="1" style="display: grid; align-content: end">upper level</dt>
            <dd class="fragment fade-in" data-fragment-index="1">\[ {\color{red}{\phi^\star}} = \arg\!\max_{\phi\in\Phi} \ \mathbb{E}_{s_0 \sim \mu_0(s_0)} \big[ J^{\textrm{real}}\left( {\color{red} {\theta^\star}}, s_0\right) \big] \]</dd>
            <dt class="fragment fade-in" data-fragment-index="2">with</dt>
            <dt class="fragment fade-in" data-fragment-index="2">lower level</dt>
            <dd class="fragment fade-in" data-fragment-index="2">\[ {\color{red}{\theta^\star(\phi)}} = \arg\! \max_{\theta\in\Theta} \ \mathbb{E}_{\xi \sim \nu(\xi;{\color{red}\phi})} \! \left[ \mathbb{E}_{s_0 \sim \mu_0(s_0;\xi)} \left[ J(\theta, \xi, s_0) \right] \right] \]</dd>
          </dl>
        </section>

        <section data-background-color="black">
          <div class="flex-container-row">
            <div class="captioned" style="width: 50vw">
              <video autoplay muted controls>
                <source src="content/videos/WAM_MuJoCo_not_transferable.mp4" type="video/mp4" />
              </video>
              <div class="top-left-caption">Learned in nominal</div>
            </div>
            <div class="captioned" style="width: 50vw">
              <video autoplay muted controls>
                <source src="content/videos/WAM_MuJoCo_transferable.mp4" type="video/mp4" />
              </video>
              <div class="top-right-caption">Learned in with BayRn</div>
            </div>
          </div>
        </section>

        <section data-background-color="black">
          <div class="flex-container-row" style="width: 160%">
            <video autoplay muted controls width="480">
              <source src="content/videos/nominal--WAM_fail.mp4" type="video/mp4" />
            </video>
            <video autoplay muted controls width="480">
              <source src="content/videos/BayRn--WAM_iter_9.mp4" type="video/mp4" />
            </video>
          </div>
        </section>

        <section data-background-color="black">
          <div class="captioned">
            <video autoplay muted controls height="540">
              <source src="content/videos/BayRn--QQ_recover.mp4" type="video/mp4" />
            </video>
            <div class="top-right-caption">Evaluating BayRn on the Furuta Pendulum</div>
          </div>
        </section>

        <section>
          <h4>Bayesian Domain Randomization (BayRn)</h4>
          <dl>
            <dt>pros</dt>
            <dd class="famuragreen">yields a probabilistic model of the uncertainty over domain parameters</dd>
            <dd class="famuragreen fragment" data-fragment-index="1">works with very spare data (scalar returns)</dd>
            <dt class="fragment" data-fragment-index="2">cons</dt>
            <dd class="fragment" data-fragment-index="2">
              <span class="famurared">
                scalability is bounded by GP input dimension, i.e. <br />
                &#10886; 50 domain parameters will require tricks
              </span>
            </dd>
          </dl>
        </section>

        <section>
          <h4>Implementation</h4>
          <div class="flex-container-row" style="align-content: flex-start; justify-content: space-evenly">
            <div style="max-width: 25%">
              <a href="https://github.com/famura/SimuRLacra">
                <img src="content/images/SimuRLacra--logo.png" alt="SimuRLacra" style="display: block" />
              </a>
            </div>
            <div>
              <ul>
                <li>github.com/famura</li>
                <li>open-source</li>
                <li>based on PyTorch</li>
                <li>modular and tested code</li>
              </ul>
            </div>
          </div>
        </section>

        <section data-background-image="content/images/Bayrn--WAM_bic_sequence.png" data-background-size="contain">
          <h3 class="title">
            Data-efficient <br />
            Domain Randomization <br />
            with <br />
            Bayesian Optimization
          </h3>
          <p>
            <b>
              Fabio Muratore<sup>1,2</sup>, Christian Eilers<sup>1,2</sup>,
              <br />
              Michael Gienger<sup>2</sup>, Jan Peters<sup>1</sup>
            </b>
          </p>
          <p>
            <sup>1</sup> Technical University of Darmstadt <br />
            <sup>2</sup> Honda Research Institute Europe
          </p>
        </section>
      </div>
    </div>

    <!-- =============================================================================================================== -->

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/math/math.js"></script>
    <!--  -->
    <!--<script src="plugin/diagram/demo/reveal.js/lib/js/head.min.js"></script> -->
    <!--  -->
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        controls: true, // video controls
        progress: true, // progress bar
        history: true, // push each slide change to the browser history, implies hash: true
        // width: '60%',  // weird scaling of the textwidth
        // center: true,  // center vertically
        transition: "slide", // https://revealjs.com/transitions/
        slideNumber: "c", // https://revealjs.com/slide-numbers/
        viewDistance: 3,
        math: {
          mathjax: "https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js",
          // mathjax: 'plugin/math/MathJax/es5/tex-chtml-full.js',
          config: "TeX-AMS_HTML-full", // https://docs.mathjax.org/en/v2.7-latest/config-files.html
          // Pass other options into `MathJax.Hub.Config()`
          TeX: {
            inlineMath: [
              ["$", "$"],
              ["\\(", "\\)"],
            ], // @TAMAS: inline symbols are not working for local mathjax
            packages: {"[+]": ["csquotes"]}, // @TAMAS: mathjax: lower case, reaveal: upper case
            Macros: {RR: "{\\bf R}", diff: "\\mathrm{d}"},
          },
          "HTML-CSS": {
            // https://docs.mathjax.org/en/v2.7-latest/options/output-processors/HTML-CSS.html#configure-html-css
            scale: 80, // adjusts the container of mathjax equations
          },
        },
        plugins: [RevealMath, RevealHighlight], // https://revealjs.com/plugins/

        dependencies: [
          // { src: 'plugin/math/math.js', async: true }, // loads MathJax from the internet if not specified above (math: { ... mathjax: ... ) )

          // Headers and footers
          {
            src: "plugin/header-footer/header-footer.js",
            async: true,
            callback: function () {
              slide_header.initialize({
                header: {
                  logoRight: "./content/images/TUD--logo_cropped_inverted_transparent.png",
                  logoLeft: "./content/images/HRI--logo_cropped_inverted_transparent.png",
                  background: "rgba(170, 34, 51, 0)", // = #a23
                },
                footer: {
                  background: "rgba(170, 34, 51, 0)", // = #a23
                  // logoRight: './content/images/TUD--logo_cropped_inverted_transparent.png',
                  // logoLeft: './content/images/HRI--logo_cropped_inverted_transparent.png',
                  text: "Fabio Muratore &ensp; | &ensp; Intelligent Autonomous Systems Group &ensp; | &ensp; Honda Research Institute Europe &ensp; | &ensp; XX.XX.2021",
                },
              })
            },
          },
          {src: "plugin/reveald3/reveald3.js"}, // https://github.com/gcalmettes/reveal.js-d3
        ],
      }) // end Reveal.initialize()
    </script>

    <!-- =============================================================================================================== -->
  </body>
</html>
